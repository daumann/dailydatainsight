var logoArray_de=["http://upload.wikimedia.org/wikipedia/commons/c/c5/Logo_FC_Bayern_M%C3%BCnchen.svg",
    "http://upload.wikimedia.org/wikipedia/commons/5/56/FC_N%C3%BCrnberg.svg",
    "http://upload.wikimedia.org/wikipedia/commons/6/67/Borussia_Dortmund_logo.svg",
    "http://upload.wikimedia.org/wikipedia/de/6/6d/FC_Schalke_04_Logo.svg",
    "http://upload.wikimedia.org/wikipedia/commons/6/66/HSV-Logo.svg",
    "http://upload.wikimedia.org/wikipedia/commons/a/ab/VfB_Stuttgart_Logo.svg",
    "http://upload.wikimedia.org/wikipedia/de/c/cc/Borussia_Moenchengladbach_Logo.svg",
    "http://upload.wikimedia.org/wikipedia/commons/b/be/SV-Werder-Bremen-Logo.svg",
    "http://upload.wikimedia.org/wikipedia/commons/d/d3/Logo_1_FC_Kaiserslautern.svg",
    "http://upload.wikimedia.org/wikipedia/de/1/16/1._FC_K%C3%B6ln.svg",
    "http://upload.wikimedia.org/wikipedia/de/5/57/VfB_Leipzig_-_1902-1922.svg",
    "http://upload.wikimedia.org/wikipedia/en/6/6d/SpVgg_Greuther_F%C3%BCrth_logo.svg",
    "http://upload.wikimedia.org/wikipedia/de/3/38/Hertha_BSC_Logo.svg",
    "http://upload.wikimedia.org/wikipedia/de/7/70/Viktoria_89_Berlin_Logo.svg",
    "http://upload.wikimedia.org/wikipedia/de/8/8e/DSCFahneHistorisch.svg",
    "http://upload.wikimedia.org/wikipedia/de/c/cd/Hannover_96_Logo.svg",
    "http://upload.wikimedia.org/wikipedia/commons/8/83/Karlsruher_FV_Logo.svg",
    "http://upload.wikimedia.org/wikipedia/de/3/30/Holstein_Kiel_Logo.svg",
    "http://upload.wikimedia.org/wikipedia/commons/4/48/TSV_1860_M%C3%BCnchen.svg",
    "http://upload.wikimedia.org/wikipedia/en/9/94/Fortuna_D%C3%BCsseldorf.svg",
    "http://upload.wikimedia.org/wikipedia/commons/0/04/Eintracht_Frankfurt_Logo.svg",
    "http://upload.wikimedia.org/wikipedia/de/8/8c/SpVgg._Blau-Wei%C3%9F_90_Berlin_%281985-1992%29.svg",
    "http://upload.wikimedia.org/wikipedia/en/6/60/Eintracht_Braunschweig_logo.svg",
    "http://upload.wikimedia.org/wikipedia/de/8/8a/Logo_Rot-Weiss_Essen.svg",
    "http://upload.wikimedia.org/wikipedia/de/3/3d/Freiburger_FC.svg",
    "http://upload.wikimedia.org/wikipedia/commons/2/28/Phoenix_Karlsruhe_Wappen.svg",
    "http://upload.wikimedia.org/wikipedia/de/4/49/VfR_Mannheim.svg",
    "http://upload.wikimedia.org/wikipedia/de/e/e5/Logo_SK_Rapid_Wien.svg",
    "http://upload.wikimedia.org/wikipedia/de/c/ce/VfL_Wolfsburg_Logo.svg"];

var logoArray_en=["http://upload.wikimedia.org/wikipedia/en/7/7a/Manchester_United_FC_crest.svg",
    "http://upload.wikimedia.org/wikipedia/en/0/0c/Liverpool_FC.svg",
    "http://upload.wikimedia.org/wikipedia/en/5/53/Arsenal_FC.svg",
    "http://upload.wikimedia.org/wikipedia/fr/8/8c/Everton_F.C._%282013%29.svg",
    "http://upload.wikimedia.org/wikipedia/en/1/15/Aston_Villa.svg",
    "http://upload.wikimedia.org/wikipedia/en/thumb/7/77/Logo_Sunderland.svg/300px-Logo_Sunderland.svg.png",
    "http://upload.wikimedia.org/wikipedia/en/c/cf/Manchester_City.svg",

    "http://upload.wikimedia.org/wikipedia/en/c/cc/Chelsea_FC.svg",
    "http://upload.wikimedia.org/wikipedia/en/5/56/Newcastle_United_Logo.svg",
    "http://upload.wikimedia.org/wikipedia/en/a/a5/Sheffield_Wednesday.svg",
    "http://upload.wikimedia.org/wikipedia/de/d/de/Leeds_United.svg",
    "http://upload.wikimedia.org/wikipedia/en/f/fc/Wolverhampton_Wanderers.svg",
    "http://upload.wikimedia.org/wikipedia/fr/3/34/Huddersfield_town_fc.svg",
    "http://upload.wikimedia.org/wikipedia/en/0/0f/Blackburn_Rovers.svg",
    "http://upload.wikimedia.org/wikipedia/de/1/12/Preston_North_End.svg",
    "http://upload.wikimedia.org/wikipedia/en/b/b4/Tottenham_Hotspur.svg",
    "http://upload.wikimedia.org/wikipedia/de/0/02/Derby_county_fc%28neu%29.svg",
    "http://upload.wikimedia.org/wikipedia/de/4/49/FC_Burnley.svg",
    "http://upload.wikimedia.org/wikipedia/de/b/b5/Portsmouth_FC_2008.svg",
    "http://upload.wikimedia.org/wikipedia/en/4/43/Ipswich_Town.svg",
    "http://upload.wikimedia.org/wikipedia/en/d/d2/Nottingham_Forest_logo.svg",
    "http://upload.wikimedia.org/wikipedia/en/9/9c/Sheffield_United_FC_logo.svg",
    "http://upload.wikimedia.org/wikipedia/en/8/8b/West_Bromwich_Albion.svg"];

var logoArray_sp=["http://upload.wikimedia.org/wikipedia/en/5/56/Real_Madrid_CF.svg",
    "http://upload.wikimedia.org/wikipedia/en/9/96/FCB.svg",
    "http://upload.wikimedia.org/wikipedia/en/c/c1/Atletico_Madrid_logo.svg",
    "http://upload.wikimedia.org/wikipedia/en/9/98/Club_Athletic_Bilbao_logo.svg",
    "http://upload.wikimedia.org/wikipedia/de/7/75/FC_Valencia.svg",
    "http://upload.wikimedia.org/wikipedia/en/f/f1/Real_Sociedad_logo.svg",
    "http://upload.wikimedia.org/wikipedia/en/4/4e/RC_Deportivo_La_Coru%C3%B1a_logo.svg",
    "http://upload.wikimedia.org/wikipedia/de/c/c0/FC_Sevilla.svg",
    "http://upload.wikimedia.org/wikipedia/en/1/13/Real_betis_logo.svg"];


var championshipCountArray_de=[24,9,8,7,6,5,5,4,4,3,3,3,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1];
var championshipCountArray_en=[20,18,13,9,7,6,4,4,4,4,3,3,3,3,2,2,2,2,2,1,1,1,1];
var championshipCountArray_sp=[32,22,10,8,6,2,1,1,1];




var width = 900,//document.body.clientWidth (initialLogoSize*championshipCountArray.length),
    height = 490;
var initialLogoSize = width/40;


drawLogoCloud(championshipCountArray_sp,logoArray_sp, "Total La Liga championships won (1929-2014)");
drawLogoCloud(championshipCountArray_en,logoArray_en, "Total Premiere League championships won (1888-2014)");
drawLogoCloud(championshipCountArray_de,logoArray_de, "Total Bundesliga championships won (1903-2014)");

function drawLogoCloud(championshipCountArray, logoArray, capture){
var svg = d3.select("#contentSVG").append("svg")
    .attr("width", width)
    .attr("height", height);

	
//START xAxis

//Scales
var xScale  = d3.scale.linear().domain([0, championshipCountArray[0]+5]).range([0, width]);

//GridLines
var xAxis = d3.svg.axis()
                        .scale(xScale)
                        .orient("top")
                        .ticks(championshipCountArray[0])
                        .tickSize(-height, 0, 0)
                        ;
				console.debug("xScale(5): "+xScale(5));		
	svg.append("g")         
			.attr("class", "grid")
			.attr("transform", "translate(5," + 20 + ")")
			.call(xAxis);
			
			d3.selectAll("line").attr("stroke","lightgray");

//Labels


	
var isFullHeight = false;
var lastHeight = 0;

var logoG = svg.append("g").attr("id","logoG");
var currentValue = -1;
var sameCount = -1;
var lastItem = -1;

for (var i=0;i<championshipCountArray.length;i++)
{ 

console.debug(xScale(championshipCountArray[i]) + " " +xScale(32));

var img = logoG.append("svg:image")
    .attr("xlink:href", logoArray[i])
	.attr("id", championshipCountArray[i])
	.attr("class", championshipCountArray[i])
    .attr("width", (initialLogoSize+(3*championshipCountArray[i])))
    .attr("height", (initialLogoSize+(3*championshipCountArray[i])))
    .attr("x",xScale(championshipCountArray[i]))
    .attr("y", function()
	
	    {
			if (currentValue == championshipCountArray[i])
			{
				sameCount++;
				
			}
			else
			{
				currentValue = championshipCountArray[i];
				sameCount= 0;
			}
			
			if (sameCount == 0)
			{
				return (height/2-(initialLogoSize+(1.7*championshipCountArray[i])));
			}
			else if (sameCount%2 == 0)
			{
				return (height/2-(sameCount/2+1)*(initialLogoSize+(3*championshipCountArray[i])));
			}
			else
			{
				if (lastHeight < (height/2+(((sameCount+1)/2)-1)*(initialLogoSize+(3*championshipCountArray[i]))))
				{
					lastHeight = (height/2+(((sameCount+1)/2)-1)*(initialLogoSize+(3*championshipCountArray[i])));
				}
				
				return (height/2+(((sameCount+1)/2)-1)*(initialLogoSize+(3*championshipCountArray[i])));
			
			}
		/*	
			console.debug(sameCount +" other in this column, drawing i "+championshipCountArray[i]+" at y "+ initialLogoSize*i);
			lastHeight = (initialLogoSize*i);
			if (((initialLogoSize*i)+initialLogoSize) < height) 
				{ return (initialLogoSize*i); }
			else 
				{ isFullHeight = true; return (height+300-(initialLogoSize*i));}
				

				
				*/ 
		});
		
}
	//	console.debug("height of last element"+ lastHeight +" and isFullHeight "+isFullHeight )
		
		
		if (!isFullHeight)
		{
			svg.attr("height", lastHeight);
		console.debug("height "+height +"     -lastHeight " +lastHeight);
			logoG.attr("transform", "translate(5,-"+(Math.abs((height-lastHeight)/2-20)+")"));
			
			

		}
			svg.append("text")
    .attr("id", "xlabel")
    .attr("class", "xlabel")
    .attr("text-anchor", "end")
	.style("stroke","none")
	.style("font-family","sans-serif")
    .attr("x", width )
    .attr("y", svg.attr("height") - 6)
    .text(capture);
			
	

$('svg image').tipsy({ 
	gravity: 'w', 
	html: true, 
	title: function() {
	console.debug(this.getAttribute("class"));
	  return 'Won '+this.getAttribute("class") +' championships'; 
	}
});

}
